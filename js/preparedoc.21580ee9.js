"use strict";(self["webpackChunk_2022_f2e_week2"]=self["webpackChunk_2022_f2e_week2"]||[]).push([[738],{584:function(e,t,a){a.d(t,{Z:function(){return c}});var n=a(3396),l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M623.6 316.7C593.6 290.4 554 276 512 276s-81.6 14.5-111.6 40.7C369.2 344 352 380.7 352 420v7.6c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V420c0-44.1 43.1-80 96-80s96 35.9 96 80c0 31.1-22 59.6-56.1 72.7-21.2 8.1-39.2 22.3-52.1 40.9-13.1 19-19.9 41.8-19.9 64.9V620c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-22.7a48.3 48.3 0 0130.9-44.8c59-22.7 97.1-74.7 97.1-132.5.1-39.3-17.1-76-48.3-103.3zM472 732a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"question-circle",theme:"outlined"},o=l,i=a(9388);function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},n=Object.keys(a);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),n.forEach((function(t){r(e,t,a[t])}))}return e}function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var u=function(e,t){var a=s({},e,t.attrs);return(0,n.Wm)(i.Z,s({},a,{icon:o}),null)};u.displayName="QuestionCircleOutlined",u.inheritAttrs=!1;var c=u},8896:function(e,t,a){a.d(t,{Z:function(){return c}});var n=a(3396),l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M858.5 763.6a374 374 0 00-80.6-119.5 375.63 375.63 0 00-119.5-80.6c-.4-.2-.8-.3-1.2-.5C719.5 518 760 444.7 760 362c0-137-111-248-248-248S264 225 264 362c0 82.7 40.5 156 102.8 201.1-.4.2-.8.3-1.2.5-44.8 18.9-85 46-119.5 80.6a375.63 375.63 0 00-80.6 119.5A371.7 371.7 0 00136 901.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8 2-77.2 33-149.5 87.8-204.3 56.7-56.7 132-87.9 212.2-87.9s155.5 31.2 212.2 87.9C779 752.7 810 825 812 902.2c.1 4.4 3.6 7.8 8 7.8h60a8 8 0 008-8.2c-1-47.8-10.9-94.3-29.5-138.2zM512 534c-45.9 0-89.1-17.9-121.6-50.4S340 407.9 340 362c0-45.9 17.9-89.1 50.4-121.6S466.1 190 512 190s89.1 17.9 121.6 50.4S684 316.1 684 362c0 45.9-17.9 89.1-50.4 121.6S557.9 534 512 534z"}}]},name:"user",theme:"outlined"},o=l,i=a(9388);function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},n=Object.keys(a);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),n.forEach((function(t){r(e,t,a[t])}))}return e}function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var u=function(e,t){var a=s({},e,t.attrs);return(0,n.Wm)(i.Z,s({},a,{icon:o}),null)};u.displayName="UserOutlined",u.inheritAttrs=!1;var c=u},3848:function(e,t,a){a.d(t,{W:function(){return n},q:function(){return l}});const n=e=>{console.log("canvas: ",e);const t=new window.jsPDF,a=e.toDataURL("image/JPEG"),n=t.internal.pageSize.width,l=t.internal.pageSize.height;t.addImage(a,"JPEG",0,0,n,l),t.save("download.pdf")},l=e=>{console.log("canvasList: ",e);const t=new window.jsPDF;e.forEach(((e,a)=>{a>0&&t.addPage();const n=t.internal.pageSize.width,l=t.internal.pageSize.height,o=e.toDataURL("image/JPEG");t.addImage(o,"JPEG",0,0,n,l)})),t.save("download.pdf")}},4645:function(e,t,a){a.d(t,{Tk:function(){return o},kj:function(){return i},vp:function(){return l}});a(2801),a(7658);window.pdfjsLib.GlobalWorkerOptions.workerSrc="https://mozilla.github.io/pdf.js/build/pdf.worker.js";const n=e=>new Promise(((t,a)=>{const n=new FileReader;n.addEventListener("load",(()=>t(n.result))),n.addEventListener("error",a),n.readAsDataURL(e)})),l=async e=>{const t="data:application/pdf;base64,";e=await n(e);const a=atob(e.substring(t.length)),l=await window.pdfjsLib.getDocument({data:a}).promise;return l.numPages},o=async e=>{const t=1/window.devicePixelRatio;return new window.fabric.Image(e,{id:"renderPDF",scaleX:t,scaleY:t})},i=async e=>{const t="data:application/pdf;base64,";e=await n(e);const a=atob(e.substring(t.length)),l=await window.pdfjsLib.getDocument({data:a}).promise,o=l.numPages;console.log("totalPages: ",o);const i=async e=>{const t=await l.getPage(e),a=t.getViewport({scale:window.devicePixelRatio}),n=document.createElement("canvas"),o=n.getContext("2d");n.height=a.height,n.width=a.width;const i={canvasContext:o,viewport:a},s=t.render(i);return s.promise.then((()=>n))},s=[];for(let n=1;n<=o;n++){const e=await i(n);s.push(e)}return{pagesCanvas:s,pages:o}}},4292:function(e,t,a){a.d(t,{Z:function(){return g}});var n=a(3396);const l=["src"],o={key:1},i=(0,n._)("div",{class:"ant-upload-text"},"Upload",-1);function s(e,t,a,s,r,u){const c=(0,n.up)("loading-outlined"),d=(0,n.up)("plus-outlined"),p=(0,n.up)("a-upload");return(0,n.wg)(),(0,n.j4)(p,{"file-list":e.fileList,"onUpdate:file-list":t[0]||(t[0]=t=>e.fileList=t),customRequest:e.customRequest,accept:"application/pdf",name:"avatar","list-type":"picture-card",class:"avatar-uploader","show-upload-list":!1,"before-upload":e.beforeUpload,onChange:e.handleChange},{default:(0,n.w5)((()=>[e.imageUrl?((0,n.wg)(),(0,n.iD)("img",{key:0,src:e.imageUrl,alt:"avatar"},null,8,l)):((0,n.wg)(),(0,n.iD)("div",o,[e.loading?((0,n.wg)(),(0,n.j4)(c,{key:0})):((0,n.wg)(),(0,n.j4)(d,{key:1})),i]))])),_:1},8,["file-list","customRequest","before-upload","onChange"])}var r=a(2510),u=a(7081),c=a(2074),d=a(4870),p=a(65),m=(0,n.aZ)({emits:["upload-success"],components:{LoadingOutlined:r.Z,PlusOutlined:u.Z},setup(e,{emit:t}){const a=(0,p.oR)(),n=(0,d.iH)([]),l=(0,d.iH)(!1),o=(0,d.iH)(""),i=e=>new Promise((t=>{setTimeout((()=>{t(e.file.status="done")}),2e3)})),s=e=>{r(e.file)&&(setTimeout((()=>{"done"!==e.file.status&&(e.file.status="done",s(e))}),2e3),"uploading"!==e.file.status?"done"===e.file.status&&(a.commit("SET_PDF_FILE",e.file),l.value=!1,c.ZP.success("上傳成功"),t("upload-success")):l.value=!0)},r=e=>{const t=e.size/1024/1024<10;return t},u=e=>{const t=r(e);return t||c.ZP.error("檔案超過 10MB，請選擇其他檔案上傳"),t};return{fileList:n,loading:l,imageUrl:o,handleChange:s,beforeUpload:u,customRequest:i}}}),f=a(89);const b=(0,f.Z)(m,[["render",s]]);var g=b},2065:function(e,t,a){a.d(t,{Z:function(){return k}});var n=a(3396);const l=e=>((0,n.dD)("data-v-26abb0d3"),e=e(),(0,n.Cn)(),e),o={class:"navbar bg-white"},i={class:"button-content"},s=l((()=>(0,n._)("p",null,"確定要放棄編輯文件嗎？",-1)));function r(e,t,a,l,r,u){const c=(0,n.up)("a-step"),d=(0,n.up)("a-steps"),p=(0,n.up)("QuestionCircleOutlined"),m=(0,n.up)("a-button"),f=(0,n.up)("a-space"),b=(0,n.up)("a-modal");return(0,n.wg)(),(0,n.iD)("div",o,[(0,n.Wm)(d,{current:e.current,size:"small",class:"step-bar desktop"},{default:(0,n.w5)((()=>[(0,n.Wm)(c,{title:"上傳檔案"}),(0,n.Wm)(c,{title:"確認上傳檔案"}),(0,n.Wm)(c,{title:"製作簽署檔案"}),(0,n.Wm)(c,{title:"下載簽署檔案"})])),_:1},8,["current"]),(0,n.Wm)(d,{current:e.current,responsive:!1,direction:"horizontal",size:"small",class:"step-bar mobile"},{default:(0,n.w5)((()=>[(0,n.Wm)(c),(0,n.Wm)(c),(0,n.Wm)(c),(0,n.Wm)(c)])),_:1},8,["current"]),(0,n._)("div",i,[(0,n.Wm)(f,{size:16},{default:(0,n.w5)((()=>[(0,n.Wm)(p),(0,n.WI)(e.$slots,"right",{},(()=>[(0,n.Wm)(m,{type:"primary",ghost:"",onClick:e.showModal},{default:(0,n.w5)((()=>[(0,n.Uk)("取消")])),_:1},8,["onClick"]),e.okBtn?((0,n.wg)(),(0,n.j4)(m,{key:0,type:"primary",onClick:e.handleClickOk,disabled:e.isDisabledOk},{default:(0,n.w5)((()=>[(0,n.Uk)("下一步")])),_:1},8,["onClick","disabled"])):(0,n.kq)("",!0)]),!0)])),_:3})]),(0,n.Wm)(b,{visible:e.visible,"onUpdate:visible":t[0]||(t[0]=t=>e.visible=t),title:"警告",onOk:e.handleOk},{footer:(0,n.w5)((()=>[(0,n.Wm)(m,{key:"back",onClick:e.handleCancel},{default:(0,n.w5)((()=>[(0,n.Uk)("取消")])),_:1},8,["onClick"]),(0,n.Wm)(m,{key:"submit",type:"primary",onClick:e.modalOk},{default:(0,n.w5)((()=>[(0,n.Uk)("確認")])),_:1},8,["onClick"])])),default:(0,n.w5)((()=>[s])),_:1},8,["visible","onOk"])])}var u=a(3848),c=a(8896),d=a(3927),p=a(5747),m=a(584),f=a(4870),b=a(65);const g=[{path:"index",breadcrumbName:"First-level Menu"},{path:"first",breadcrumbName:"Second-level Menu"},{path:"second",breadcrumbName:"Third-level Menu"}];var v=(0,n.aZ)({props:{okBtn:{type:Boolean,default:!0},onOk:{type:Function,default:()=>{}},isDisabledOk:{type:Boolean,default:!1},modalOk:{type:Function,default:()=>{}}},components:{UserOutlined:c.Z,SearchOutlined:d.Z,DownOutlined:p.Z,QuestionCircleOutlined:m.Z},setup(e){const t=(0,b.oR)(),a=(0,n.Fl)((()=>t.state.progress)),l=(0,f.iH)(!1),o=(0,n.Fl)((()=>t.state.canvasInstanceList)),i=()=>{l.value=!0},s=e=>{l.value=!1},r=()=>{l.value=!1},c=()=>{e.onOk()},d=()=>{},p=(0,f.iH)(!1),m=()=>{(0,u.q)(o.value)};return{downloadPDF2:m,activeKey:(0,f.iH)("1"),current:a,routes:g,visible:l,showModal:i,handleCancel:r,handleOk:s,goNextPage:d,isDisabled:p,handleClickOk:c}}}),w=a(89);const h=(0,w.Z)(v,[["render",r],["__scopeId","data-v-26abb0d3"]]);var k=h},6021:function(e,t,a){a.r(t),a.d(t,{default:function(){return j}});var n=a(3396),l=a(7139);const o=e=>((0,n.dD)("data-v-eba456cc"),e=e(),(0,n.Cn)(),e),i={class:"task-page"},s={class:"container max-1010"},r=o((()=>(0,n._)("div",null,null,-1))),u={class:"doc-card-header"},c={class:"update-file-info"},d={class:"page text-neutral-6"},p={class:"file-info-name text-neutral-7"},m=o((()=>(0,n._)("div",{class:"task-content"},null,-1)));function f(e,t,a,o,f,b){const g=(0,n.up)("SignSendNavbar"),v=(0,n.up)("LeftOutlined"),w=(0,n.up)("router-link"),h=(0,n.up)("a-input"),k=(0,n.up)("a-form-item"),O=(0,n.up)("LoadingOutlined"),y=(0,n.up)("a-select"),C=(0,n.up)("a-form"),_=(0,n.up)("a-card");return(0,n.wg)(),(0,n.iD)("div",i,[(0,n.Wm)(g,{onOk:e.goNextPage,isDisabledOk:e.disableOkBtn,modalOk:e.modalOk},null,8,["onOk","isDisabledOk","modalOk"]),(0,n._)("div",s,[(0,n.Wm)(_,{class:"doc-card"},{default:(0,n.w5)((()=>[r,(0,n._)("div",u,[(0,n.Wm)(w,{to:"/sign-and-send/"},{default:(0,n.w5)((()=>[(0,n.Wm)(v),(0,n.Uk)(" 上一步")])),_:1})]),(0,n.Wm)(C,(0,n.dG)({"label-col":e.labelCol,"wrapper-col":e.wrapperCol,class:"doc-form",layout:"vertical",model:e.formState},e.layout,{name:"nest-messages","validate-messages":e.validateMessages,onFinish:e.onFinish}),{default:(0,n.w5)((()=>[(0,n.Wm)(k,{"label-col":e.labelCol,name:["user","name"],label:"文件名稱",rules:[{required:!0}]},{default:(0,n.w5)((()=>[(0,n.Wm)(h,{value:e.formState.user.name,"onUpdate:value":t[0]||(t[0]=t=>e.formState.user.name=t),placeholder:"請輸入檔案名稱"},null,8,["value"])])),_:1},8,["label-col"]),(0,n.Wm)(k,{"label-col":e.labelCol,name:["user","email"],label:"上傳文件",rules:[{required:!0}]},{default:(0,n.w5)((()=>[(0,n._)("div",c,[e.$store.state.pdfFile&&0===e.totalPages?((0,n.wg)(),(0,n.j4)(O,{key:0})):((0,n.wg)(),(0,n.iD)(n.HY,{key:1},[(0,n._)("div",d,(0,l.zw)(e.totalPages)+"頁",1),(0,n._)("div",p,(0,l.zw)(e.formState.user.email),1)],64))])])),_:1},8,["label-col"]),(0,n.Wm)(k,{name:["user","labels"],label:"建立標籤","label-col":e.labelCol},{default:(0,n.w5)((()=>[(0,n.Wm)(y,{value:e.formState.user.labels,"onUpdate:value":t[1]||(t[1]=t=>e.formState.user.labels=t),mode:"tags",style:{width:"100%"},placeholder:"請輸入標籤名稱",options:e.options,onChange:e.handleChange},null,8,["value","options","onChange"])])),_:1},8,["label-col"])])),_:1},16,["label-col","wrapper-col","model","validate-messages","onFinish"])])),_:1})]),m])}a(7658);var b=a(4292),g=a(4645),v=a(7081),w=a(2510),h=a(1127),k=a(4870),O=a(2483),y=a(65),C=a(2065),_=a(2074),P=(0,n.aZ)({components:{PlusOutlined:v.Z,LoadingOutlined:w.Z,LeftOutlined:h.Z,FileUploader:b.Z,SignSendNavbar:C.Z},setup(){const e=(0,O.tv)(),t=(0,y.oR)(),a=(0,k.iH)(0),l={labelCol:{span:2}},o={required:"${label}不可空白"},i=(0,k.qj)({user:{name:"",labels:[],email:"",website:"",introduction:""}}),s=(0,n.Fl)((()=>""===i.user.name.trim()));(0,n.wF)((()=>{const a=t.state.pdfFile;a||e.replace({path:"/task"})})),(0,O.ao)(((e,t)=>{})),(0,n.bv)((()=>{t.commit("SET_PROGRESS_STATE",1);const e=t.state.pdfFile;e&&(i.user.name=e.name,i.user.email=e.name,(0,g.vp)(e.originFileObj).then((e=>{a.value=e})).catch((e=>{throw _.ZP.warn("發生未知錯誤"),new Error(e)})))}));const r=()=>{e.push({name:"assign-fields"})},u=e=>{},c=e=>{r()},d=()=>{t.commit("SET_PDF_FILE",null),e.replace({name:"task"})},p=e=>{};return{totalPages:a,handleMenuClick:u,activeKey:(0,k.iH)("1"),formState:i,modalOk:d,onFinish:c,layout:l,validateMessages:o,value:(0,k.iH)([]),handleChange:p,goNextPage:r,disableOkBtn:s,labelCol:{},wrapperCol:{},options:["產品教學","產品流程","產品試用","產品A","產品B"].map((e=>({value:e})))}}}),S=a(89);const W=(0,S.Z)(P,[["render",f],["__scopeId","data-v-eba456cc"]]);var j=W}}]);
//# sourceMappingURL=preparedoc.21580ee9.js.map